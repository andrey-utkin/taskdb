From cb5a4cf0ae16c3a81451c895dea011e1baaeee13 Mon Sep 17 00:00:00 2001
From: Andrey Utkin <andrey_utkin@fastmail.com>
Date: Thu, 6 Sep 2018 19:55:36 +0100
Subject: [PATCH 1/3] Allow to set event UID from KHAL_UID env var

---
 khal/utils.py | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/khal/utils.py b/khal/utils.py
index 2587b6c..aec9d78 100644
--- a/khal/utils.py
+++ b/khal/utils.py
@@ -22,6 +22,7 @@
 """this module contains some helper functions converting strings or list of
 strings to date(time) or event objects"""
 
+import os
 from calendar import isleap, month_abbr
 from collections import defaultdict
 from datetime import date, datetime, timedelta, time
@@ -575,7 +576,11 @@ def new_event(locale, dtstart=None, dtend=None, summary=None, timezone=None,
     event.add('dtend', dtend)
     event.add('dtstamp', datetime.now())
     event.add('summary', summary)
-    event.add('uid', generate_random_uid())
+    uid = os.getenv('KHAL_UID')
+    if uid:
+        event.add('uid', uid)
+    else:
+        event.add('uid', generate_random_uid())
     # event.add('sequence', 0)
 
     if description:
-- 
2.16.4

